<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cycle Companion</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin: 0; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    const CycleCompanion = () => {
      const [cycleLength, setCycleLength] = useState(28);
      const [lastPeriodStart, setLastPeriodStart] = useState(null);
      const [currentMonth, setCurrentMonth] = useState(new Date());

      useEffect(() => {
        const saved = localStorage.getItem('cycleData');
        if (saved) {
          const data = JSON.parse(saved);
          if (data.lastPeriodStart) {
            setLastPeriodStart(new Date(data.lastPeriodStart));
          }
          if (data.cycleLength) {
            setCycleLength(data.cycleLength);
          }
        }
      }, []);

      useEffect(() => {
        if (lastPeriodStart) {
          localStorage.setItem('cycleData', JSON.stringify({
            lastPeriodStart: lastPeriodStart.toISOString(),
            cycleLength
          }));
        }
      }, [lastPeriodStart, cycleLength]);

      const getCycleDay = (date) => {
        if (!lastPeriodStart) return null;
        const diff = Math.floor((date - lastPeriodStart) / (1000 * 60 * 60 * 24));
        return ((diff % cycleLength) + cycleLength) % cycleLength + 1;
      };

      const getCurrentPhase = () => {
        const today = new Date();
        const cycleDay = getCycleDay(today);
        if (!cycleDay) return null;

        if (cycleDay <= 5) return 'menstrual';
        if (cycleDay <= 13) return 'follicular';
        if (cycleDay <= 17) return 'ovulatory';
        return 'luteal';
      };

      const phaseInfo = {
        menstrual: {
          name: 'Menstrual',
          color: 'from-red-400 to-pink-400',
          days: '1-5',
          description: 'Your period begins. Hormone levels (estrogen and progesterone) are at their lowest.',
          energy: 'Energy may be low. Focus on rest, gentle movement, and iron-rich foods.',
          partnerTip: 'Offer warmth and comfort. Heat packs, favorite snacks, and understanding go a long way.'
        },
        follicular: {
          name: 'Follicular',
          color: 'from-green-400 to-emerald-400',
          days: '6-13',
          description: 'Estrogen rises as your body prepares to release an egg. You may feel more energetic and optimistic.',
          energy: 'Great time for new projects, workouts, and socializing.',
          partnerTip: 'Join in on activities! Support their energy and enthusiasm for trying new things.'
        },
        ovulatory: {
          name: 'Ovulatory',
          color: 'from-yellow-400 to-orange-400',
          days: '14-17',
          description: 'Estrogen peaks and an egg is released. Many feel confident and outgoing.',
          energy: 'Peak energy and communication. Perfect for important meetings or social events.',
          partnerTip: 'Great time for connection and date nights. They may feel especially social and confident.'
        },
        luteal: {
          name: 'Luteal',
          color: 'from-purple-400 to-indigo-400',
          days: '18-28',
          description: 'Progesterone rises then falls if pregnancy doesn\'t occur. PMS symptoms may appear toward the end.',
          energy: 'Energy may decrease. Focus on self-care, gentle exercise, and comforting foods.',
          partnerTip: 'Offer extra patience and help with household chores. Be understanding of mood changes and cravings.'
        }
      };

      const isPeriodDay = (date) => {
        const cycleDay = getCycleDay(date);
        return cycleDay && cycleDay <= 5;
      };

      const isPredictedPeriod = (date) => {
        const cycleDay = getCycleDay(date);
        return cycleDay && cycleDay <= 5 && date > new Date();
      };

      const getDaysInMonth = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDayOfWeek = firstDay.getDay();
        
        return { daysInMonth, startingDayOfWeek };
      };

      const renderCalendar = () => {
        const { daysInMonth, startingDayOfWeek } = getDaysInMonth(currentMonth);
        const days = [];
        
        for (let i = 0; i < startingDayOfWeek; i++) {
          days.push(<div key={`empty-${i}`} className="aspect-square" />);
        }
        
        for (let day = 1; day <= daysInMonth; day++) {
          const date = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);
          const isToday = date.toDateString() === new Date().toDateString();
          const isPeriod = isPeriodDay(date);
          const isPredicted = isPredictedPeriod(date);
          const isSelected = lastPeriodStart && date.toDateString() === lastPeriodStart.toDateString();
          
          days.push(
            <button
              key={day}
              onClick={() => setLastPeriodStart(date)}
              className={`aspect-square rounded-lg flex items-center justify-center text-sm font-medium transition-all
                ${isToday ? 'ring-2 ring-white' : ''}
                ${isPeriod ? 'bg-red-400 text-white' : ''}
                ${isPredicted ? 'bg-pink-200 text-pink-800' : ''}
                ${isSelected ? 'ring-2 ring-yellow-400' : ''}
                ${!isPeriod && !isPredicted ? 'hover:bg-white/20' : ''}
              `}
            >
              {day}
            </button>
          );
        }
        
        return days;
      };

      const changeMonth = (delta) => {
        setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + delta, 1));
      };

      const currentPhase = getCurrentPhase();
      const cycleDay = getCycleDay(new Date());

      return (
        <div className="min-h-screen bg-gradient-to-br from-pink-200 via-purple-200 to-indigo-200 p-4 md:p-8 font-sans">
          <div className="max-w-6xl mx-auto">
            <header className="text-center mb-8">
              <h1 className="text-4xl md:text-5xl font-bold text-purple-900 mb-2">Cycle Companion</h1>
              <p className="text-purple-700">Track, understand, and embrace your cycle</p>
            </header>

            <div className="grid md:grid-cols-2 gap-6 mb-6">
              <div className="bg-white/30 backdrop-blur-lg rounded-3xl p-6 shadow-xl">
                <div className="flex items-center justify-between mb-4">
                  <button onClick={() => changeMonth(-1)} className="p-2 hover:bg-white/30 rounded-lg text-2xl">‚Üê</button>
                  <h2 className="text-xl font-bold text-purple-900">
                    {currentMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                  </h2>
                  <button onClick={() => changeMonth(1)} className="p-2 hover:bg-white/30 rounded-lg text-2xl">‚Üí</button>
                </div>
                
                <div className="grid grid-cols-7 gap-2 mb-2">
                  {['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'].map(day => (
                    <div key={day} className="text-center text-sm font-semibold text-purple-800">{day}</div>
                  ))}
                </div>
                
                <div className="grid grid-cols-7 gap-2">
                  {renderCalendar()}
                </div>

                <div className="mt-4 space-y-2 text-sm">
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-4 bg-red-400 rounded"></div>
                    <span className="text-purple-900">Current Period</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-4 bg-pink-200 rounded"></div>
                    <span className="text-purple-900">Predicted Period</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-4 border-2 border-yellow-400 rounded"></div>
                    <span className="text-purple-900">Period Start</span>
                  </div>
                </div>

                <div className="mt-4">
                  <label className="block text-sm font-medium text-purple-900 mb-2">
                    Cycle Length (days)
                  </label>
                  <input
                    type="number"
                    min="21"
                    max="35"
                    value={cycleLength}
                    onChange={(e) => setCycleLength(parseInt(e.target.value))}
                    className="w-full px-4 py-2 rounded-lg bg-white/50 border-2 border-purple-300 focus:border-purple-500 outline-none"
                  />
                </div>
              </div>

              <div className="space-y-6">
                {currentPhase && (
                  <div className={`bg-gradient-to-br ${phaseInfo[currentPhase].color} rounded-3xl p-6 shadow-xl text-white`}>
                    <div className="flex items-center justify-between mb-4">
                      <h2 className="text-2xl font-bold">{phaseInfo[currentPhase].name} Phase</h2>
                      <span className="text-4xl">üìÖ</span>
                    </div>
                    
                    <div className="mb-4">
                      <div className="flex justify-between text-sm mb-2">
                        <span>Day {cycleDay} of {cycleLength}</span>
                        <span>Days {phaseInfo[currentPhase].days}</span>
                      </div>
                      <div className="w-full bg-white/30 rounded-full h-3">
                        <div 
                          className="bg-white rounded-full h-3 transition-all duration-500"
                          style={{ width: `${(cycleDay / cycleLength) * 100}%` }}
                        />
                      </div>
                    </div>

                    <div className="space-y-3">
                      <div className="bg-white/20 backdrop-blur-sm rounded-xl p-3">
                        <div className="flex items-start gap-2">
                          <span className="text-xl">‚ÑπÔ∏è</span>
                          <p className="text-sm">{phaseInfo[currentPhase].description}</p>
                        </div>
                      </div>
                      
                      <div className="bg-white/20 backdrop-blur-sm rounded-xl p-3">
                        <div className="flex items-start gap-2">
                          <span className="text-xl">üìà</span>
                          <p className="text-sm">{phaseInfo[currentPhase].energy}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {!currentPhase && (
                  <div className="bg-white/30 backdrop-blur-lg rounded-3xl p-6 shadow-xl text-center">
                    <span className="text-6xl block mb-4">üìÖ</span>
                    <h3 className="text-xl font-bold text-purple-900 mb-2">Get Started</h3>
                    <p className="text-purple-700">Click a date on the calendar to mark the start of your last period</p>
                  </div>
                )}

                {currentPhase && (
                  <div className="bg-white/30 backdrop-blur-lg rounded-3xl p-6 shadow-xl">
                    <div className="flex items-center gap-2 mb-3">
                      <span className="text-2xl">üíï</span>
                      <h3 className="text-xl font-bold text-purple-900">Partner Tips</h3>
                    </div>
                    <p className="text-purple-800">{phaseInfo[currentPhase].partnerTip}</p>
                  </div>
                )}
              </div>
            </div>

            <div className="bg-white/30 backdrop-blur-lg rounded-3xl p-6 shadow-xl">
              <h2 className="text-2xl font-bold text-purple-900 mb-6 text-center">Phase Deep Dive</h2>
              
              <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                {Object.entries(phaseInfo).map(([key, phase]) => (
                  <div key={key} className="bg-white/40 rounded-2xl p-4">
                    <div className={`bg-gradient-to-br ${phase.color} text-white rounded-xl p-3 mb-3`}>
                      <h3 className="font-bold text-lg">{phase.name}</h3>
                      <p className="text-sm opacity-90">Days {phase.days}</p>
                    </div>
                    <p className="text-sm text-purple-900 mb-2">{phase.description}</p>
                    <p className="text-sm text-purple-700">{phase.energy}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<CycleCompanion />, document.getElementById('root'));
  </script>
</body>
</html>
